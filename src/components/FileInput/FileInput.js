import React, { useState } from 'react';
import { FormattedMessage } from 'react-intl';
import styled from 'astroturf';

const FileInputContainer = styled.label`
  display: inline-flex;
  align-items: center;
  align-content: center;
  position: relative;
  line-height: 0;
  cursor: pointer;
`;

const FileInputElement = styled.input`
  position: absolute;
  left: -9999px;
  opacity: 0;
`;

const AttachIcon = styled.svg`
  height: 28px;
  margin-right: 32px;
`;

const FileInputLabelText = styled.span`
  line-height: 24px;
`;

export function FileInput({ onChange, required }) {
  const [fileName, setFileName] = useState(null);

  function handleChange(event) {
    const file = Array.from(event.target.files)[0];

    onChange(file);
    setFileName(file.name);
  }

  return (
    <FileInputContainer htmlFor="fileElem">
      <FileInputElement
        type="file"
        id="fileElem"
        multiple={false}
        required={required}
        onChange={handleChange}
      />
      <AttachIcon
        viewBox="0 0 15 26"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M5.66812 1.25792H5.72502C5.87916 1.26102 6.03434 1.27033 6.18743 1.28792C6.5433 1.32826 6.89399 1.41102 7.23018 1.53412C7.86741 1.76791 8.44881 2.1455 8.92258 2.63066C9.38396 3.10343 9.74084 3.67445 9.96017 4.29721C10.0729 4.61789 10.1495 4.95102 10.1878 5.28825C10.2053 5.44135 10.2147 5.59653 10.2178 5.75066V5.80963C10.2178 9.68377 10.2426 13.559 10.2178 17.4331C10.2157 17.5438 10.2084 17.6545 10.195 17.7641C10.1629 18.0135 10.0988 18.2586 10.0036 18.4903C9.77914 19.0407 9.38292 19.5155 8.88327 19.8362C8.635 19.9945 8.36397 20.1155 8.07947 20.1921C7.78671 20.2717 7.48051 20.3038 7.17742 20.2883C6.84639 20.2728 6.51845 20.1993 6.21226 20.0721C5.88433 19.9355 5.58227 19.739 5.32467 19.4938C5.04949 19.2321 4.82709 18.9166 4.67296 18.569C4.55813 18.3103 4.48158 18.0342 4.44641 17.7528C4.43193 17.6348 4.42572 17.5159 4.42469 17.3969L4.42469 6.63728C4.42675 6.59486 4.42572 6.58349 4.43607 6.5421C4.45469 6.46348 4.49606 6.39107 4.55503 6.33624C4.67296 6.22452 4.85193 6.19245 5.00192 6.25762C5.04641 6.27624 5.08779 6.30314 5.12192 6.33624C5.15709 6.36935 5.18606 6.40866 5.20882 6.45107C5.22951 6.49452 5.24399 6.54107 5.24916 6.58969C5.25123 6.60521 5.25123 6.62073 5.25227 6.63728C5.25227 10.2402 5.18606 13.8445 5.2533 17.4475C5.26158 17.7351 5.32778 18.0185 5.45088 18.2792C5.56675 18.5254 5.73123 18.7468 5.93295 18.9299C6.12019 19.0995 6.33951 19.235 6.5764 19.3261C6.79777 19.4109 7.03261 19.4585 7.2695 19.4637C7.49501 19.4699 7.72156 19.4388 7.93673 19.3716C8.16845 19.2992 8.38672 19.1864 8.57914 19.0385C8.87604 18.8109 9.1088 18.5026 9.24741 18.154C9.34258 17.912 9.38809 17.6544 9.39016 17.3947L9.39016 5.80646C9.38809 5.74335 9.38809 5.68025 9.38499 5.61715C9.37775 5.47646 9.36327 5.33577 9.33947 5.19613C9.28982 4.8951 9.20189 4.59924 9.07982 4.31889C8.80879 3.70235 8.37016 3.16338 7.82086 2.77236C7.47638 2.52822 7.09156 2.34202 6.685 2.22719C6.35396 2.13305 6.00948 2.08546 5.66499 2.08546H5.62258H5.60189L5.59051 2.0865C5.56982 2.0865 5.55637 2.08753 5.5274 2.08753C5.48189 2.0896 5.43534 2.09271 5.38982 2.09581C5.26775 2.10615 5.14672 2.1196 5.02568 2.14133C4.75673 2.18788 4.49293 2.26443 4.24053 2.36891C4.08225 2.43512 3.92915 2.51167 3.78121 2.59753L3.7688 2.60477C3.52673 2.74856 3.30122 2.92029 3.09741 3.11477C2.89259 3.30926 2.7095 3.52753 2.55431 3.76442L2.54707 3.7758L2.545 3.7789C2.38672 4.02097 2.25742 4.28165 2.16018 4.55373C2.06294 4.82579 1.99673 5.10926 1.96466 5.3958C1.96259 5.41752 1.96052 5.44028 1.95846 5.462C1.94811 5.57787 1.94294 5.69476 1.9419 5.81165C1.91397 10.2475 1.91501 14.6823 1.9419 19.1171C1.94604 19.3177 1.95846 19.5164 1.98328 19.7139C2.04225 20.1929 2.16639 20.6636 2.35155 21.1094C2.54396 21.576 2.80361 22.0146 3.11809 22.4087C3.46361 22.8411 3.87637 23.2198 4.33671 23.526C4.84672 23.8663 5.41567 24.1187 6.00946 24.2677C6.52463 24.397 7.05841 24.4498 7.58806 24.4239C8.20254 24.3929 8.81082 24.2563 9.37977 24.0205C9.98908 23.7681 10.5508 23.4029 11.0287 22.9477C11.5398 22.4615 11.9536 21.875 12.2391 21.2294C12.4439 20.7691 12.5825 20.2798 12.6508 19.7801C12.6839 19.537 12.6984 19.2939 12.7005 19.0498L12.7005 6.63713C12.7046 6.5854 12.7025 6.57092 12.717 6.52023C12.7563 6.38678 12.8639 6.2792 12.9973 6.23989C13.0356 6.22954 13.0749 6.22333 13.1142 6.22333C13.1339 6.22333 13.1536 6.22644 13.1732 6.22747C13.1929 6.23161 13.2115 6.23575 13.2311 6.23989C13.2798 6.25851 13.2932 6.26058 13.3377 6.28954C13.4215 6.3423 13.4836 6.42609 13.5115 6.52023C13.526 6.57092 13.5239 6.5854 13.528 6.63713C13.528 10.801 13.5529 14.9646 13.528 19.1274C13.5218 19.4088 13.5011 19.6891 13.4598 19.9674C13.3739 20.5426 13.2073 21.1053 12.9653 21.6339C12.626 22.3746 12.1408 23.046 11.5439 23.6005C10.9863 24.1177 10.3325 24.5315 9.62598 24.8139C8.96701 25.0777 8.26255 25.2267 7.55186 25.2536C6.96636 25.2753 6.37773 25.2132 5.80878 25.0705C5.12187 24.8977 4.46603 24.6081 3.8774 24.215C3.325 23.8467 2.83258 23.3894 2.42395 22.865C2.06705 22.4056 1.77431 21.8967 1.5581 21.3557C1.36052 20.8622 1.22707 20.3439 1.1619 19.8164C1.13293 19.5877 1.11948 19.3581 1.11431 19.1274C1.08742 14.6873 1.08638 10.2475 1.11431 5.80742V5.7526C1.11535 5.73501 1.11535 5.71639 1.11638 5.69777C1.11638 5.67708 1.11638 5.65535 1.11742 5.63363C1.11948 5.59018 1.12155 5.54673 1.12466 5.50432V5.50018L1.12569 5.49294V5.48777C1.12879 5.44329 1.13293 5.39984 1.13707 5.35536C1.14328 5.29432 1.14948 5.23432 1.15879 5.17432C1.20535 4.83916 1.29017 4.50916 1.41017 4.19261C1.52189 3.90088 1.66258 3.62054 1.83225 3.3578C2.0288 3.04952 2.26259 2.76504 2.52845 2.5116C2.77466 2.27781 3.04672 2.07194 3.33845 1.89816C3.565 1.76264 3.80293 1.64782 4.04914 1.55367C4.38327 1.42643 4.73292 1.33954 5.08673 1.29402C5.16742 1.28471 5.24811 1.27643 5.32879 1.27023C5.40224 1.26505 5.47569 1.26195 5.54914 1.25988L5.5781 1.25885C5.58845 1.25885 5.59879 1.25781 5.60914 1.25781L5.66812 1.25792Z"
          fill="black"
          stroke="black"
        />
      </AttachIcon>
      {fileName ? (
        <FileInputLabelText>{fileName}</FileInputLabelText>
      ) : (
        <FormattedMessage id="attach_resume" />
      )}
    </FileInputContainer>
  );
}

FileInput.defaultProps = {
  required: false,
};
